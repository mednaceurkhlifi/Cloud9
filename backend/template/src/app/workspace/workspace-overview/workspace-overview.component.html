<div class="card !mb-8">
    <div class="card">
        <div class="font-bold text-4xl mb-4">Workspace</div>
        <p-fieldset legend="What is ?" [toggleable]="true">
            <p class="m-0 text-lg">
                Welcome to your Workspace â€” the place where your ideas turn into action. Here, you can create and manage
                all
                your projects and tasks in a clean, organized space built to help you stay focused and productive. Your
                Workspace gives you full control to plan, track, and bring your goals
                to life.
            </p>
        </p-fieldset>
        <p-fieldset legend="How it look ?" [toggleable]="true">
            <div class="card flex justify-center">
                <p-organization-chart [value]="data" />
            </div>
        </p-fieldset>
    </div>
</div>

<p-fluid *ngIf="!isWkFound && wkForm">
    <div class="card !mb-8">
        <div class="card flex flex-col gap-6 w-full">
            <div class="font-bold text-2xl mb-4">Create yours now !</div>
            <form [formGroup]="wkForm" (ngSubmit)="createWorkspace()" class="font-semibold gap-6 text-xl mb-4">
                <p-message *ngIf="wkForm.invalid && !wkForm.untouched" severity="error" icon="pi pi-times-circle"
                           styleClass="mb-2">Validation Failed
                </p-message>
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="flex flex-wrap gap-2 w-full">
                        <label for="name" class="text-lg">Name</label>
                        <input pInputText id="name" type="text" formControlName="name" />
                        <p-message *ngIf="wkForm.get('name')?.invalid && wkForm.get('name')?.touched" severity="error"
                                   variant="simple">Workspace name is required
                        </p-message>
                    </div>
                </div>

                <div class="flex flex-wrap">
                    <label for="description" class="text-lg">Description</label>
                    <textarea pTextarea id="description" rows="4" formControlName="description"></textarea>
                    <p-message *ngIf="wkForm.get('description')?.invalid && wkForm.get('description')?.touched"
                               severity="error" variant="simple">Description is required
                    </p-message>
                </div>

                <div class="card">

                    <p-fileupload [multiple]="false" accept="image/*" maxFileSize="1000000" mode="advanced">
                        <ng-template #empty>
                            <div>Drag and drop workspace image to here.</div>
                        </ng-template>
                        <ng-template #content>
                            <ul *ngIf="image">
                                <li>{{ image.name }} - {{ image.size }} bytes</li>
                            </ul>
                        </ng-template>
                    </p-fileupload>
                </div>
                <div class="flex justify-end mt-4">
                    <p-button label="Save" icon="pi pi-check" iconPos="right"
                              styleClass="text-lg font-semibold px-4 py-2 w-40" [disabled]="wkForm.invalid" />
                </div>

            </form>
        </div>
    </div>
</p-fluid>


<div class="card !mb-8" *ngIf="isWkFound">
    <div class="workspace-card">
        <div class="workspace-group">
            <img src="workspace/images/default_workspace.jpg" alt="workspace image">
            <span class="title">{{ workspaceResponse.projection?.name | uppercase }}</span>
        </div>
        <div class="workspace-description">
            <p>{{ workspaceResponse.projection?.description }}</p>
            <span>Created at : {{workspaceResponse.projection?.createdAt | date: 'medium' }}</span>
        </div>
    </div>
    <div class="card">
        <p-table
            #dt2
            [value]="workspaceResponse.projectResponse?.projection!"
            dataKey="id"
            [rows]="10"
            [rowsPerPageOptions]="[10, 25, 50]"
            [loading]="loading"
            [paginator]="true"
            [globalFilterFields]="['name', 'country.name', 'representative.name', 'status']"
            [tableStyle]="{ 'min-width': '75rem' }"
        >
            <ng-template #header>
                <tr>
                    <th style="width:22%">Name</th>
                    <th style="width:22%">Image</th>
                    <th style="width:22%">Description</th>
                    <th style="width:22%">Begin date</th>
                    <th style="width:22%">Deadline</th>
                    <th style="width:22%">Priority</th>
                    <th style="width:22%">Status</th>
                </tr>
            </ng-template>
            <ng-template #body let-project>
                <tr>
                    <td>
                        {{ project.name }}
                    </td>
                    <td>
                        <div class="flex items-center gap-2">
                            <img src="https://primefaces.org/cdn/primeng/images/demo/flag/flag_placeholder.png" style="width: 20px" />
                        </div>
                    </td>
                    <td>
                        {{ project.description }}
                    </td>
<!--                    <td>-->
<!--                        <p-tag [value]="customer.status" [severity]="getSeverity(customer.status)" />-->
<!--                    </td>-->
                    <td>
                        {{ project.beginDate }}
                    </td>
                    <td>
                        {{ project.deadline }}
                    </td>
                    <td>
                        {{ project.priority }}
                    </td>
                    <td>
                        {{ project.status }}
                    </td>
                </tr>
            </ng-template>
            <ng-template #emptymessage>
                <tr>
                    <td colspan="5">No projects found.</td>
                </tr>
            </ng-template>
        </p-table>
    </div>
</div>
